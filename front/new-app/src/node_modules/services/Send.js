import React, {useContext, useState} from 'react'

const BASE_HOST = 'http://localhost:8090';

const Send = async (method, url, value, page) => {

    const headers = {
        'Content-Type': 'application/json', 
        Authorization: `${localStorage.getItem('token')}`
    }; 
    
    const res = await fetch(`${BASE_HOST}${url}`, {
        method: page ? 'POST' : method,
        headers,
        body: page && value ? JSON.stringify({page, value}) : value ? JSON.stringify(value) : JSON.stringify(page)
    });

    if (!res.ok) {

        if (res.status === 400 || res.status === 403) { 
            const error = await res.json();
       
            if (error)
                
                throw new Error(error.errors.map(item=>{
     
                    return item.message

                }));
        }

        throw new Error(`Could not fetch data because of error status: ${res.status}.`);
    }

    return res.json();
}

export default Send;